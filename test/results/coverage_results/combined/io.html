<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>io</title></head>
<body>
<h1>io.c (0/0) -</h1>
<code style="display: block">
#include&nbsp;&quot;sail.h&quot;<br>
#include&nbsp;&quot;io.h&quot;<br>
<br>
#include&nbsp;&lt;stdlib.h&gt;<br>
#include&nbsp;&lt;unistd.h&gt;<br>
#include&nbsp;&lt;termios.h&gt;<br>
#include&nbsp;&lt;stdio.h&gt;<br>
#include&nbsp;&lt;ctype.h&gt;<br>
#include&nbsp;&lt;sys/time.h&gt;<br>
#include&nbsp;&lt;sys/types.h&gt;<br>
<br>
unsigned&nbsp;char&nbsp;*memory;<br>
<br>
unit&nbsp;mem_init(const&nbsp;unit&nbsp;u)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;memory&nbsp;=&nbsp;calloc((0b1&nbsp;&lt;&lt;&nbsp;16),&nbsp;sizeof(unsigned&nbsp;char));<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;UNIT;<br>
}<br>
<br>
uint8_t&nbsp;mem_read(const&nbsp;sail_int&nbsp;addr)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;memory[mpz_get_ui(addr)];<br>
}<br>
<br>
unit&nbsp;mem_write(const&nbsp;sail_int&nbsp;addr,&nbsp;const&nbsp;sail_int&nbsp;data)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;memory[mpz_get_ui(addr)]&nbsp;=&nbsp;mpz_get_ui(data);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;UNIT;<br>
}<br>
<br>
unit&nbsp;mem_load(const&nbsp;sail_string&nbsp;path,&nbsp;const&nbsp;sail_int&nbsp;start_addr)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;FILE&nbsp;*code&nbsp;=&nbsp;fopen(path,&nbsp;&quot;rb&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!code)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;offset&nbsp;=&nbsp;mpz_get_ui(start_addr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;read&nbsp;=&nbsp;fread(memory&nbsp;+&nbsp;offset,&nbsp;sizeof(unsigned&nbsp;char),&nbsp;(0b1&nbsp;&lt;&lt;&nbsp;16)&nbsp;-&nbsp;offset,&nbsp;code);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;UNIT;<br>
}<br>
</code>
</body>
</html>